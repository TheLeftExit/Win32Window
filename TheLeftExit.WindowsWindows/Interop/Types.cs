using System.Drawing;
using System.Runtime.InteropServices;

[Flags]
public enum WINDOW_EX_STYLE : uint
{
    WS_EX_DLGMODALFRAME = 0x00000001,
    WS_EX_NOPARENTNOTIFY = 0x00000004,
    WS_EX_TOPMOST = 0x00000008,
    WS_EX_ACCEPTFILES = 0x00000010,
    WS_EX_TRANSPARENT = 0x00000020,
    WS_EX_MDICHILD = 0x00000040,
    WS_EX_TOOLWINDOW = 0x00000080,
    WS_EX_WINDOWEDGE = 0x00000100,
    WS_EX_CLIENTEDGE = 0x00000200,
    WS_EX_CONTEXTHELP = 0x00000400,
    WS_EX_RIGHT = 0x00001000,
    WS_EX_LEFT = 0x00000000,
    WS_EX_RTLREADING = 0x00002000,
    WS_EX_LTRREADING = 0x00000000,
    WS_EX_LEFTSCROLLBAR = 0x00004000,
    WS_EX_RIGHTSCROLLBAR = 0x00000000,
    WS_EX_CONTROLPARENT = 0x00010000,
    WS_EX_STATICEDGE = 0x00020000,
    WS_EX_APPWINDOW = 0x00040000,
    WS_EX_OVERLAPPEDWINDOW = 0x00000300,
    WS_EX_PALETTEWINDOW = 0x00000188,
    WS_EX_LAYERED = 0x00080000,
    WS_EX_NOINHERITLAYOUT = 0x00100000,
    WS_EX_NOREDIRECTIONBITMAP = 0x00200000,
    WS_EX_LAYOUTRTL = 0x00400000,
    WS_EX_COMPOSITED = 0x02000000,
    WS_EX_NOACTIVATE = 0x08000000,
}

[Flags]
public enum WINDOW_STYLE : uint
{
    WS_OVERLAPPED = 0x00000000,
    WS_POPUP = 0x80000000,
    WS_CHILD = 0x40000000,
    WS_MINIMIZE = 0x20000000,
    WS_VISIBLE = 0x10000000,
    WS_DISABLED = 0x08000000,
    WS_CLIPSIBLINGS = 0x04000000,
    WS_CLIPCHILDREN = 0x02000000,
    WS_MAXIMIZE = 0x01000000,
    WS_CAPTION = 0x00C00000,
    WS_BORDER = 0x00800000,
    WS_DLGFRAME = 0x00400000,
    WS_VSCROLL = 0x00200000,
    WS_HSCROLL = 0x00100000,
    WS_SYSMENU = 0x00080000,
    WS_THICKFRAME = 0x00040000,
    WS_GROUP = 0x00020000,
    WS_TABSTOP = 0x00010000,
    WS_MINIMIZEBOX = 0x00020000,
    WS_MAXIMIZEBOX = 0x00010000,
    WS_TILED = 0x00000000,
    WS_ICONIC = 0x20000000,
    WS_SIZEBOX = 0x00040000,
    WS_TILEDWINDOW = 0x00CF0000,
    WS_OVERLAPPEDWINDOW = 0x00CF0000,
    WS_POPUPWINDOW = 0x80880000,
    WS_CHILDWINDOW = 0x40000000,
    WS_ACTIVECAPTION = 0x00000001,
}

public enum SHOW_WINDOW_CMD : uint
{
    SW_HIDE = 0U,
    SW_SHOWNORMAL = 1U,
    SW_NORMAL = 1U,
    SW_SHOWMINIMIZED = 2U,
    SW_SHOWMAXIMIZED = 3U,
    SW_MAXIMIZE = 3U,
    SW_SHOWNOACTIVATE = 4U,
    SW_SHOW = 5U,
    SW_MINIMIZE = 6U,
    SW_SHOWMINNOACTIVE = 7U,
    SW_SHOWNA = 8U,
    SW_RESTORE = 9U,
    SW_SHOWDEFAULT = 10U,
    SW_FORCEMINIMIZE = 11U,
    SW_MAX = 11U,
}

[StructLayout(LayoutKind.Sequential)]
public struct MSG
{
    public nint hwnd;
    public WINDOW_MESSAGE message;
    public nint wParam;
    public nint lParam;
    public uint time;
    public Point pt;
}

// https://stackoverflow.com/q/75304403
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
public unsafe struct WNDCLASSEXW
{
    public uint cbSize;
    public WNDCLASS_STYLES style;
    public nint lpfnWndProc;
    public int cbClsExtra;
    public int cbWndExtra;
    public nint hInstance;
    public nint hIcon;
    public nint hCursor;
    public nint hbrBackground;
    public nint lpszMenuName;
    public nint lpszClassName;
    public nint hIconSm;
}

public enum WNDCLASS_STYLES : uint
{
    CS_VREDRAW = 0x00000001,
    CS_HREDRAW = 0x00000002,
    CS_DBLCLKS = 0x00000008,
    CS_OWNDC = 0x00000020,
    CS_CLASSDC = 0x00000040,
    CS_PARENTDC = 0x00000080,
    CS_NOCLOSE = 0x00000200,
    CS_SAVEBITS = 0x00000800,
    CS_BYTEALIGNCLIENT = 0x00001000,
    CS_BYTEALIGNWINDOW = 0x00002000,
    CS_GLOBALCLASS = 0x00004000,
    CS_IME = 0x00010000,
    CS_DROPSHADOW = 0x00020000,
}

public unsafe delegate nint WNDPROC(nint hwnd, WINDOW_MESSAGE uMsg, nint wParam, nint lParam);

public enum GET_STOCK_OBJECT_FLAGS : uint
{
    BLACK_BRUSH = 4U,
    DKGRAY_BRUSH = 3U,
    DC_BRUSH = 18U,
    GRAY_BRUSH = 2U,
    HOLLOW_BRUSH = 5U,
    LTGRAY_BRUSH = 1U,
    NULL_BRUSH = 5U,
    WHITE_BRUSH = 0U,
    BLACK_PEN = 7U,
    DC_PEN = 19U,
    NULL_PEN = 8U,
    WHITE_PEN = 6U,
    ANSI_FIXED_FONT = 11U,
    ANSI_VAR_FONT = 12U,
    DEVICE_DEFAULT_FONT = 14U,
    DEFAULT_GUI_FONT = 17U,
    OEM_FIXED_FONT = 10U,
    SYSTEM_FONT = 13U,
    SYSTEM_FIXED_FONT = 16U,
    DEFAULT_PALETTE = 15U,
}

// https://github.com/terrafx/terrafx.interop.windows/blob/main/sources/Interop/Windows/Windows/um/dwmapi/DWMWINDOWATTRIBUTE.cs
public enum DWMWINDOWATTRIBUTE
{
    DWMWA_NCRENDERING_ENABLED = 1,
    DWMWA_NCRENDERING_POLICY,
    DWMWA_TRANSITIONS_FORCEDISABLED,
    DWMWA_ALLOW_NCPAINT,
    DWMWA_CAPTION_BUTTON_BOUNDS,
    DWMWA_NONCLIENT_RTL_LAYOUT,
    DWMWA_FORCE_ICONIC_REPRESENTATION,
    DWMWA_FLIP3D_POLICY,
    DWMWA_EXTENDED_FRAME_BOUNDS,
    DWMWA_HAS_ICONIC_BITMAP,
    DWMWA_DISALLOW_PEEK,
    DWMWA_EXCLUDED_FROM_PEEK,
    DWMWA_CLOAK,
    DWMWA_CLOAKED,
    DWMWA_FREEZE_REPRESENTATION,
    DWMWA_PASSIVE_UPDATE_MODE,
    DWMWA_USE_HOSTBACKDROPBRUSH,
    DWMWA_USE_IMMERSIVE_DARK_MODE = 20,
    DWMWA_WINDOW_CORNER_PREFERENCE = 33,
    DWMWA_BORDER_COLOR,
    DWMWA_CAPTION_COLOR,
    DWMWA_TEXT_COLOR,
    DWMWA_VISIBLE_FRAME_BORDER_THICKNESS,
    DWMWA_SYSTEMBACKDROP_TYPE,
    DWMWA_LAST,
}

public enum SYS_COLOR_INDEX
{
    COLOR_SCROLLBAR = 0,
    COLOR_BACKGROUND = 1,
    COLOR_ACTIVECAPTION = 2,
    COLOR_INACTIVECAPTION = 3,
    COLOR_MENU = 4,
    COLOR_WINDOW = 5,
    COLOR_WINDOWFRAME = 6,
    COLOR_MENUTEXT = 7,
    COLOR_WINDOWTEXT = 8,
    COLOR_CAPTIONTEXT = 9,
    COLOR_ACTIVEBORDER = 10,
    COLOR_INACTIVEBORDER = 11,
    COLOR_APPWORKSPACE = 12,
    COLOR_HIGHLIGHT = 13,
    COLOR_HIGHLIGHTTEXT = 14,
    COLOR_BTNFACE = 15,
    COLOR_BTNSHADOW = 16,
    COLOR_GRAYTEXT = 17,
    COLOR_BTNTEXT = 18,
    COLOR_INACTIVECAPTIONTEXT = 19,
    COLOR_BTNHIGHLIGHT = 20,
    COLOR_3DDKSHADOW = 21,
    COLOR_3DLIGHT = 22,
    COLOR_INFOTEXT = 23,
    COLOR_INFOBK = 24,
    COLOR_HOTLIGHT = 26,
    COLOR_GRADIENTACTIVECAPTION = 27,
    COLOR_GRADIENTINACTIVECAPTION = 28,
    COLOR_MENUHILIGHT = 29,
    COLOR_MENUBAR = 30,
    COLOR_DESKTOP = 1,
    COLOR_3DFACE = 15,
    COLOR_3DSHADOW = 16,
    COLOR_3DHIGHLIGHT = 20,
    COLOR_3DHILIGHT = 20,
    COLOR_BTNHILIGHT = 20,
}